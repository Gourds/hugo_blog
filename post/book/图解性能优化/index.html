<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>《图解性能优化》笔记 - Gourds</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="Gourds" />
  <meta name="description" content="终于要开始阅读这本期待已久的书籍图灵系列丛书中信出版《图解性能优化》，不得不说接触的这几本图解系列都蛮不错的，读完再来前面补充。 性能的基础知" />
<meta name="keywords" content="性能优化" />



<meta name="baidu-site-verification" content="code-XsKZoymEBo" />
<meta name="google-site-verification" content="G-LVSQVTKWX5" />


<meta name="generator" content="Hugo 0.85.0" />


<link rel="canonical" href="https://blog.gourds.site/post/book/%E5%9B%BE%E8%A7%A3%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.fa4b2b9f31b5c6d0b683db81157a9226e17b06e61911791ab547242a4a0556f2.css" integrity="sha256-&#43;ksrnzG1xtC2g9uBFXqSJuF7BuYZEXkatUckKkoFVvI=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="《图解性能优化》笔记" />
<meta property="og:description" content="终于要开始阅读这本期待已久的书籍图灵系列丛书中信出版《图解性能优化》，不得不说接触的这几本图解系列都蛮不错的，读完再来前面补充。 性能的基础知" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.gourds.site/post/book/%E5%9B%BE%E8%A7%A3%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2018-08-14T23:08:22+08:00" />
<meta property="article:modified_time" content="2018-08-14T23:08:22+08:00" />

<meta itemprop="name" content="《图解性能优化》笔记">
<meta itemprop="description" content="终于要开始阅读这本期待已久的书籍图灵系列丛书中信出版《图解性能优化》，不得不说接触的这几本图解系列都蛮不错的，读完再来前面补充。 性能的基础知"><meta itemprop="datePublished" content="2018-08-14T23:08:22+08:00" />
<meta itemprop="dateModified" content="2018-08-14T23:08:22+08:00" />
<meta itemprop="wordCount" content="3248">
<meta itemprop="keywords" content="读书," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="《图解性能优化》笔记"/>
<meta name="twitter:description" content="终于要开始阅读这本期待已久的书籍图灵系列丛书中信出版《图解性能优化》，不得不说接触的这几本图解系列都蛮不错的，读完再来前面补充。 性能的基础知"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-LVSQVTKWX5', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">进击de葫芦娃</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://blog.gourds.site/">首页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://blog.gourds.site/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://blog.gourds.site/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://blog.gourds.site/categories/">专栏</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://blog.gourds.site/book/">书单</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://blog.gourds.site/%E8%A7%82%E5%BD%B1%E6%B8%85%E5%8D%95/">观影清单</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://wiki.gourds.site" rel="noopener" target="_blank">
              Wiki
              
              <i class="iconfont">
                <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92 0 0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"></path>
  <path d="M841.152 457.152c-30.528 0-54.784 24.512-54.784 54.656l0 274.752L237.696 786.56 237.696 237.696l206.016 0c6.656 0 10.752 0 13.248 0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128L183.04 128C153.216 128 128 152.576 128 182.848c0 3.136 0.256 6.272 0.768 9.28C128.256 195.136 128 198.272 128 201.408l0 639.488c0 0.064 0 0.192 0 0.256 0 0.128 0 0.192 0 0.32 0 30.528 24.512 54.784 54.784 54.784l646.976 0c6.592 0 9.728 0 11.712 0 28.736 0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344l0-20.352L896 561.408 896 512.128C896 481.792 871.424 457.152 841.152 457.152z"></path>
</svg>

              </i>
            </a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      进击de葫芦娃
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://blog.gourds.site/">首页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://blog.gourds.site/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://blog.gourds.site/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://blog.gourds.site/categories/">专栏</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://blog.gourds.site/book/">书单</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://blog.gourds.site/%E8%A7%82%E5%BD%B1%E6%B8%85%E5%8D%95/">观影清单</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://wiki.gourds.site" rel="noopener" target="_blank">
              Wiki
              
              <i class="iconfont">
                <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92 0 0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"></path>
  <path d="M841.152 457.152c-30.528 0-54.784 24.512-54.784 54.656l0 274.752L237.696 786.56 237.696 237.696l206.016 0c6.656 0 10.752 0 13.248 0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128L183.04 128C153.216 128 128 152.576 128 182.848c0 3.136 0.256 6.272 0.768 9.28C128.256 195.136 128 198.272 128 201.408l0 639.488c0 0.064 0 0.192 0 0.256 0 0.128 0 0.192 0 0.32 0 30.528 24.512 54.784 54.784 54.784l646.976 0c6.592 0 9.728 0 11.712 0 28.736 0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344l0-20.352L896 561.408 896 512.128C896 481.792 871.424 457.152 841.152 457.152z"></path>
</svg>

              </i>
            </a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">《图解性能优化》笔记</h1>
      
      <div class="post-meta">
        <time datetime="2018-08-14" class="post-time">
          2018-08-14
        </time>
        <div class="post-category">
            <a href="https://blog.gourds.site/categories/%E8%AF%BB%E4%B8%87%E5%8D%B7%E4%B9%A6/"> 读万卷书 </a>
            
          </div>
        <span class="more-meta"> 约 3248 字 </span>
          <span class="more-meta"> 预计阅读 7 分钟 </span>

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#性能的基础知识">性能的基础知识</a></li>
        <li><a href="#性能分析的基础">性能分析的基础</a></li>
        <li><a href="#os命令">OS命令</a></li>
        <li><a href="#vmstat命令">vmstat命令</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      <p>终于要开始阅读这本期待已久的书籍<code>图灵系列丛书中信出版《图解性能优化》</code>，不得不说接触的这几本图解系列都蛮不错的，读完再来前面补充。</p>
<h3 id="性能的基础知识">性能的基础知识</h3>
<p>算法的重要性（算法对于性能的影响非常大），第一章主要是引入算法启发思考，并没有实际可操作的优化方法，不过对于算法思路应该才是最主要的。很有启发。</p>
<h4 id="响应和吞吐">响应和吞吐</h4>
<p>另外响应和吞吐对性能的影响也异常重要。首先响应和吞吐是两个截然不同的概念。</p>
<p><strong>响应：</strong> 通俗来说就是应答的快慢。体现在实际例子上比如浏览器的从输入网址到返回内容所用的时间</p>
<p><strong>吞吐：</strong> 简单来说吞吐就是单位时间可以处理事务数量的大小。比如说一个网站的最大在线人数</p>
<p>在不同业务场景下，对响应和吞吐的要求也不一样。有的系统更侧重响应，有的则更注重吞吐，但是一般来说偏重响应会更好，因为响应快的话，对应吞吐也会变大。</p>
<h4 id="算法的例子">算法的例子</h4>
<p>
<strong>数组与循环处理</strong></p>
<blockquote>
<p><strong>复杂度</strong></p>
<ul>
<li>可以通过增加数据量来确认复杂度</li>
</ul>
<p><strong>优点</strong></p>
<ul>
<li>适合循环处理，代码实现方便</li>
</ul>
<p><strong>缺点</strong></p>
<ul>
<li>不知道数组长度的话会占用过多的空间</li>
<li>中间插入数据不方便</li>
</ul>
<p><strong>改进和变种</strong></p>
<ul>
<li>数组与数组</li>
</ul>
</blockquote>
<p><strong>链表与循环</strong></p>
<blockquote>
<p><strong>优点</strong></p>
<ul>
<li>插入数据灵活</li>
</ul>
<p><strong>缺点</strong></p>
<ul>
<li>访问指定位置数据时处理繁琐</li>
</ul>
<p><strong>改进：</strong> 双向链表既可以往前遍历也可以往后遍历</p>
</blockquote>
<p><strong>树与查找</strong></p>
<blockquote>
<p>二叉树即倒置的树结构，用来查找非常好用，而且复杂度对比其他方式要好很多。优点是可以只查找相关的数据，比如查找右边就不需要查找左边，这样查找范围会明显减少。主要缺点是数据更新不方便</p>
</blockquote>
<p><strong>散列算法</strong></p>
<blockquote>
<p>散列算法是一个神奇的算法，最简单是取余数的计算。利用散列可以快速的查找数据，算法复杂度非常简单，主要缺点是对于相同的数据无能为力，另外对于不同的数据也会存在散列相同的情况，这种情况可以使用链表结构进行连接，也可以使用重新散列“rehash”将数据存放到其他位置。</p>
</blockquote>
<p><strong>队列</strong></p>
<blockquote>
<p>简单来说这里的队列就跟生活中说的队列差不多。</p>
<ul>
<li>先入先出的队列叫做有名管道（FIFO）</li>
<li>队列的复杂度较低</li>
<li>不适用与需要实时响应的系统</li>
<li>可以处理突发流量也可以连接不同系统</li>
<li>队列也是有极限的，超出极限会造成溢出</li>
</ul>
<p>一般性能问题通常是因为对队列惊醒了扫描即全部检查，或者在取数据的时候不按照放入的顺序，这时的复杂度会增加，也容易出现性能问题。</p>
</blockquote>
<p><strong>栈</strong></p>
<blockquote>
<p>栈就像不断从下往上堆积的书和文件。跟队列刚好相反，栈的处理顺序是从上往下的，也就是新来的会优先处理，比如函数调用，这种处理方式叫做FILO（first in last out）</p>
<ul>
<li>单次复杂度为O(1)</li>
<li>优点是只占用必要的空间，不会让空间产生碎片</li>
</ul>
</blockquote>
<p><strong>排序</strong></p>
<blockquote>
<p>排序就是把数据按顺序进行排列，跟生活中常见的数据排列意思一致。排序可以使数据的查找速度加快，不过数据的排序过程与之相比就显得很慢，排序是很有价值的，</p>
</blockquote>
<p><strong>缓存</strong></p>
<blockquote>
<p>缓存不能被称为算法，但是缓存也是性能提升的关键。回写（write back）这种缓存方式指的是之后数据更新的方式，即在更新数据的时候，不更新数据实际存放的地方的数据，只更新缓存内的数据，之后再更新数据实际存放的位置。</p>
</blockquote>
<p><strong>锁与性能</strong></p>
<blockquote>
<p>锁是在并行处理情况下的必要机制。常见的锁有DB中的行锁、表锁，Java的锁，CPU命令级别的锁，OS内部锁，DB内部的锁。</p>
</blockquote>
<h3 id="性能分析的基础">性能分析的基础</h3>
<p>性能分析从获取性能开始。</p>
<p><strong>性能分析的原则</strong></p>
<ul>
<li>时间区间分段查找</li>
<li>位置区间分段查找</li>
</ul>
<p><strong>性能信息的3种类型</strong></p>
<ul>
<li>概要形式（如：sar/vmstat)</li>
<li>事件记录形式（如：网络抓包、系统调用记录）；性能数据量大不适合经常在生产环境使用</li>
<li>快照形式（类似ps或者top输出的截图定期连续抓拍）</li>
</ul>
<p><strong>数据的种类以及分析的窍门</strong>
概要形式适合追溯调查之前的概况，但不适合调查问题的原因，分析问题的原因可以结合事件记录形式和快照形式来进行。</p>
<p><strong>性能分析的重要理论</strong></p>
<blockquote>
<p><strong>等待队列理论的术语</strong></p>
<ul>
<li>等待队列</li>
<li>访问等待时间</li>
<li>服务时间</li>
<li>响应时间（=访问等待+服务事件）</li>
</ul>
</blockquote>
<p><strong>计算等待队列的平均等待时间</strong></p>
<blockquote>
<ul>
<li>平均使用率=（处理时间+处理条数）/ 单位时间</li>
</ul>
</blockquote>
<h4 id="实际系统的性能分析">实际系统的性能分析</h4>
<p><strong>推荐获取的性能信息</strong></p>
<table>
<thead>
<tr>
<th>指标</th>
<th>性能信息</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>各个服务器的OS</td>
<td>vmstat 5秒间隔 连续</td>
<td></td>
</tr>
<tr>
<td></td>
<td>iostat 1分钟间隔 连续 一般观察类似DB这种对磁盘访问频繁的机器</td>
<td></td>
</tr>
<tr>
<td></td>
<td>ps 5分钟间隔 或 top 10s间隔 连续</td>
<td></td>
</tr>
<tr>
<td>WEB服务器</td>
<td>访问日志连续</td>
<td></td>
</tr>
<tr>
<td></td>
<td>AP服务器的处理等待队列信息 连续</td>
<td></td>
</tr>
<tr>
<td></td>
<td>AP服务器的线程使用情况信息 连续</td>
<td></td>
</tr>
<tr>
<td></td>
<td>AP服务器的DB连接使用情况信息 连续</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Java的GC日志 连续</td>
<td></td>
</tr>
<tr>
<td></td>
<td>Java的低负载的详细事件记录日志（如：Flight Recorder）连续</td>
<td></td>
</tr>
<tr>
<td>DB服务器</td>
<td>连接接收信息（如：listener.log） 连续</td>
<td></td>
</tr>
<tr>
<td></td>
<td>DBMS的概要信息30分钟间隔 连续</td>
<td></td>
</tr>
<tr>
<td></td>
<td>DB会话的库按照（如ASH Active Session History） 连续</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="os命令">OS命令</h3>
<p>组合利用OS命令，可以获取系统的性能信息，这个应该是最具备可操作性的，记录一下</p>
<h4 id="sar命令">sar命令</h4>
<p>此命令可以从OS的内核中获得OS的信息，不过是OS级别的信息，可以配合top命令使用</p>
<p>可以获得</p>
<blockquote>
<p>CPU的使用率和空闲情况、读写I/O的量、内存的概要信息</p>
</blockquote>
<p>不能获得</p>
<blockquote>
<p>具体各个进程的情况、瞬间的性能问题，另外sar命令查看的不是实际的物理CPU而是虚拟的CPU情况，所以存在出现在虚拟CPU看起来正在被处理但在物理CPU已经被挂起等待的情况</p>
</blockquote>
<p>使用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">sar 
<span class="c1">#直接获取</span>
sar -f
<span class="c1">#可以从已经自动记录的文件中把过去的数据显示出来</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="vmstat命令">vmstat命令</h3>
<p>使用这个命令
可以获得</p>
<blockquote>
<p>等待执行的平均进程数、由于某些原因而被迫等待阻塞的平均进程数、CPU的使用率、系统的I/O、上下文切换次数</p>
</blockquote>
<p>不能获得</p>
<blockquote>
<p>具体进程的情况、瞬间的性能问题、可能导致问题的程序或进程</p>
</blockquote>
<p>使用（可以配合top命令使用）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">vmstat
<span class="c1">#直接执行</span>
vmstat <span class="m">5</span> <span class="m">3</span>
<span class="c1">#每5秒显示一次，显示3次，一般来说看第二行以后的信息（第一行表示的是OS启动后的平均值，可以忽略）</span>
</code></pre></td></tr></table>
</div>
</div><p>命令输出特别提示</p>
<blockquote>
<p>wa列一般会作为I/O等待的指标，这个指标一般会根据r列的上升而上升，特殊情况会下降。注意b列，即使分页导致的系统变慢，b列的数值也会上升。一般认为r列的值不高于CPU核数的2倍或者4倍是正常的，但当CPU只有1个核心的时候，如果cpu使用率不高，即使出现6或者7这样的数字一般也没有问题。</p>
</blockquote>
<h4 id="ps命令">ps命令</h4>
<p>使用ps命令</p>
<p>可以获得</p>
<blockquote>
<p>某个瞬间存在哪些进程、某个瞬间进程的状态、进程的CPU累计时间</p>
</blockquote>
<p>不能获得</p>
<blockquote>
<p>内存和CPU使用率、OS的情况、运行中的各个现成的信息默认也是无法知道的</p>
</blockquote>
<p>建议</p>
<blockquote>
<p>这个命令负载较大，因此不能再短时间内重复执行，</p>
</blockquote>
<h4 id="netstat命令">netstat命令</h4>
<p>使用该命令可以测量驱动级别的信息</p>
<p>可以获得</p>
<blockquote>
<p>使用-a参数能获得命令执行瞬间的套接字，-r参数可以获得瞬间的路由信息，-i参数可以获得各个接口的统计信息</p>
</blockquote>
<p>不能获得</p>
<blockquote>
<p>不能知道网络通信是否出现了问题，因为很多故障在驱动级别不能被统计出来。</p>
</blockquote>
<h4 id="iostat命令">iostat命令</h4>
<p>使用该命令可以获得块设备（Block Device）级别的信息。在OS内核的内部，一般不会记录文件缓存等OS文件系统级别的操作，所以从OS上应用程序看到的系统性能信息与iostat级别的性能信息之间存在差异</p>
<p>可以获得</p>
<blockquote>
<p>能知道磁盘的使用率。通过-x参数，可以获得响应时间和各种队列长度。推荐使用-t和-x参数。通过使用率即繁忙度可以知道OS层面看到的磁盘运转情况，但很难通过这个繁忙度来判断物理磁盘是否已经真的接近临界值，因为很多时候存储方面已经进行了虚拟化或分割，从OS看到的磁盘信息与实际情况会有偏差。<strong>注意</strong>active和wait这两个概念，active指的是从OS的角度来看已经向磁盘发送完，wait指的是尚未发送，active和wait都有相应的队列长度和平均时间，当存储接近临界值时，首先active的队列长度应该会增加，响应也会变慢，接着wait的队列长度也会增加，响应也会变慢。svctm的列为服务时间（响应时间）</p>
</blockquote>
<p>经验</p>
<blockquote>
<p>在没有命中某个缓存的时候，一次IO响应（svctm）大概是几毫秒，当一次响应时间花费十几毫秒甚至几十毫秒的时候，就可以怀疑响应出现问题了。</p>
</blockquote>
<h4 id="top命令">top命令</h4>
<p>此命令测量的是OS级别的信息</p>
<p>可以获得</p>
<blockquote>
<p>获取实时OS整体的情况，包括系统的信息、活跃的进程并显示这些进程的信息</p>
</blockquote>
<p>不可以获得</p>
<blockquote>
<p>不能获得非活跃进程的信息</p>
</blockquote>
<p>注意</p>
<blockquote>
<p>也是一个高负载命令。另使用时键入1键可以看具体CPU核心的利用率，键入c键可以查看活跃进程的启动命令</p>
</blockquote>
<h4 id="数据包转储wiresharktcpdump等">数据包转储（wireshark、tcpdump等）</h4>

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">Gourds</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2018-08-14
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>


    
    
<div class="post-reward">
  <input type="checkbox" name="reward" id="reward" hidden />
  <label class="reward-button" for="reward">赞赏支持</label>
  <div class="qr-code">
    
    
      <label class="qr-code-image" for="reward">
        <img class="image" src="/img_own/weipay.jpg">
        <span>微信打赏</span>
      </label>
    
      <label class="qr-code-image" for="reward">
        <img class="image" src="/img_own/zhipay.jpg">
        <span>支付宝打赏</span>
      </label>
  </div>
</div>

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://blog.gourds.site/tags/%E8%AF%BB%E4%B9%A6/">读书</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/linux/centos7%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEsupervisor/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">CentOS7安装配置supervisor</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/bigdata/es%E4%BD%BF%E7%94%A8curator%E7%AE%A1%E7%90%86index/">
            <span class="next-text nav-default">Elasticsearch使用curator管理index</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  
  
  

  
  

  

  
  
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "Gourds/hugo_blog_comments"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:gourds@yeah.net" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="http://github.com/gourds" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>
  
    <a href="https://www.zhihu.com/people/gourds" rel="me noopener" class="iconfont"
      title="zhihu"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M351.791182 562.469462l192.945407 0c0-45.367257-21.3871-71.939449-21.3871-71.939449L355.897709 490.530013c3.977591-82.182744 7.541767-187.659007 8.816806-226.835262l159.282726 0c0 0-0.86367-67.402109-18.578124-67.402109s-279.979646 0-279.979646 0 16.850783-88.141456 39.318494-127.053698c0 0-83.60514-4.510734-112.121614 106.962104S81.344656 355.077018 76.80834 367.390461c-4.536316 12.313443 24.62791 5.832845 36.941354 0 12.313443-5.832845 68.050885-25.924439 84.252893-103.69571l86.570681 0c1.165546 49.28652 4.596691 200.335724 3.515057 226.835262L109.86113 490.530013c-25.275663 18.147312-33.701566 71.939449-33.701566 71.939449L279.868105 562.469462c-8.497535 56.255235-23.417339 128.763642-44.275389 167.210279-33.05279 60.921511-50.55235 116.65793-169.802314 212.576513 0 0-19.442818 14.257725 40.829917 9.073656 60.273758-5.185093 117.305683-20.739347 156.840094-99.807147 20.553105-41.107233 41.805128-93.250824 58.386782-146.138358l-0.055259 0.185218 167.855986 193.263655c0 0 22.035876-51.847855 5.832845-108.880803L371.045711 650.610918l-42.1244 31.157627-0.045025 0.151449c11.69946-41.020252 20.11206-81.5749 22.726607-116.858498C351.665315 564.212152 351.72876 563.345412 351.791182 562.469462z"></path>
  <path d="M584.918753 182.033893l0 668.840094 70.318532 0 28.807093 80.512708 121.875768-80.512708 153.600307 0L959.520453 182.033893 584.918753 182.033893zM887.150192 778.934538l-79.837326 0-99.578949 65.782216-23.537066-65.782216-24.855084 0L659.341766 256.673847l227.807403 0L887.149169 778.934538z"></path>
</svg>

    </a>


<a href="https://blog.gourds.site/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2015 -
    2021
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        Gourds
        
      </span></span>

  
  

  

  
  <script src="https://unpkg.com/mermaid@8.8.1/dist/mermaid.min.js"></script>
  <script>
        Array.from(document.getElementsByClassName('language-mermaid')).forEach(el => {
        el.parentElement.outerHTML = `<div class="mermaid">${el.innerText}</div>`
    })
  </script>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>



  <script type="text/javascript">
    window.MathJax = {
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script>



<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?7b7c5cd05ce16d342444570aeb9e9544";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>





  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  















</body>
</html>
